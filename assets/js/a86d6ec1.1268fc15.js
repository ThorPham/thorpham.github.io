"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8693],{1188:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>o,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var c=i(5533),l=i(4848),s=i(8453);const r={slug:"T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning",title:"T\xecm hi\u1ec3u v\u1ec1 th\u01b0 vi\u1ec7n keras trong deep learning",authors:"thorpham",tags:["python","Keras"],hide_table_of_contents:!0},t=void 0,d={authorsImageUrls:[void 0]},h=[{value:"C\xe1ch c\xe0i \u0111\u1eb7t :",id:"c\xe1ch-c\xe0i-\u0111\u1eb7t-",level:2},{value:"T\xecm hi\u1ec3u c\u1ea5u tr\xfac c\u1ee7a Keras",id:"t\xecm-hi\u1ec3u-c\u1ea5u-tr\xfac-c\u1ee7a-keras",level:2},{value:"\u0110\u1ea7u ti\u1ec1n l\xe0 c\xe1c module d\xf9ng \u0111\u1ec3 x\xe2y d\u1ef1ng b\u1ed9 x\u01b0\u01a1ng cho model :",id:"\u0111\u1ea7u-ti\u1ec1n-l\xe0-c\xe1c-module-d\xf9ng-\u0111\u1ec3-x\xe2y-d\u1ef1ng-b\u1ed9-x\u01b0\u01a1ng-cho-model-",level:3},{value:"Ti\u1ebfp theo ch\xfang ta t\xecm hi\u1ec3u \u0111\u1ebfn ti\u1ec1n x\u1eed l\xfd d\u1eef li\u1ec7u trong keras, n\xf3 \u0111\u01b0\u1ee3c chia ra l\xe0m 3 ph\u1ea7n :",id:"ti\u1ebfp-theo-ch\xfang-ta-t\xecm-hi\u1ec3u-\u0111\u1ebfn-ti\u1ec1n-x\u1eed-l\xfd-d\u1eef-li\u1ec7u-trong-keras-n\xf3-\u0111\u01b0\u1ee3c-chia-ra-l\xe0m-3-ph\u1ea7n-",level:3},{value:"C\xe1c function trong b\u1ed9 x\u01b0\u01a1ng c\u1ee7a model",id:"c\xe1c-function-trong-b\u1ed9-x\u01b0\u01a1ng-c\u1ee7a-model",level:3}];function a(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.p,{children:"Keras l\xe0 m\u1ed9t library \u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n v\xe0o n\u0103m 2015 b\u1edfi Fran\xe7ois Chollet, l\xe0 m\u1ed9t k\u1ef9 s\u01b0 nghi\xean c\u1ee9u deep learning t\u1ea1i google. N\xf3 l\xe0 m\u1ed9t open source cho neural network \u0111\u01b0\u1ee3c vi\u1ebft b\u1edfi ng\xf4n ng\u1eef python. keras l\xe0 m\u1ed9t API b\u1eadc cao c\xf3 th\u1ec3 s\u1eed d\u1ee5ng chung v\u1edbi c\xe1c th\u01b0 vi\u1ec7n deep learning n\u1ed5i ti\u1ebfng nh\u01b0 tensorflow(\u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n b\u1edfi gg), CNTK(\u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n b\u1edfi microsoft),theano(ng\u01b0\u1eddi ph\xe1t tri\u1ec3n ch\xednh Yoshua Bengio). keras c\xf3 m\u1ed9t s\u1ed1 \u01b0u \u0111i\u1ec3m nh\u01b0 :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"D\u1ec5 s\u1eed d\u1ee5ng,x\xe2y d\u1ef1ng model nhanh."}),"\n",(0,l.jsx)(e.li,{children:"C\xf3 th\u1ec3 run tr\xean c\u1ea3 cpu v\xe0 gpu"}),"\n",(0,l.jsx)(e.li,{children:"H\u1ed7 tr\u1ee3 x\xe2y d\u1ef1ng CNN , RNN v\xe0 c\xf3 th\u1ec3 k\u1ebft h\u1ee3p c\u1ea3 2.*"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"c\xe1ch-c\xe0i-\u0111\u1eb7t-",children:"C\xe1ch c\xe0i \u0111\u1eb7t :"}),"\n",(0,l.jsx)(e.p,{children:"Tr\u01b0\u1edbc khi c\xe0i \u0111\u1eb7t keras b\u1ea1n ph\u1ea3i c\xe0i \u0111\u1eb7t m\u1ed9t trong s\u1ed1 c\xe1c th\u01b0 vi\u1ec7n sau tensorflow,CNTK,theano. Sau \u0111\xf3 b\u1ea1n c\xf3 th\u1ec3 c\xe0i \u0111\u1eb7t b\u1eb1ng 1 s\u1ed1 l\u1ec7nh sau \u0111\u1ed1i v\u1edbi window:"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"pip install keras"}),"\n",(0,l.jsx)(e.li,{children:"conda install keras"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"t\xecm-hi\u1ec3u-c\u1ea5u-tr\xfac-c\u1ee7a-keras",children:"T\xecm hi\u1ec3u c\u1ea5u tr\xfac c\u1ee7a Keras"}),"\n",(0,l.jsx)(e.p,{children:"C\u1ea5u tr\xfac c\u1ee7a keras ch\xfang ta c\xf3 th\u1ec3 chia ra th\xe0nh 3 ph\u1ea7n ch\xednh :"}),"\n",(0,l.jsx)("center",{children:(0,l.jsx)("img",{width:"600",height:"300",src:i(4774).A})}),"\n",(0,l.jsx)(e.h3,{id:"\u0111\u1ea7u-ti\u1ec1n-l\xe0-c\xe1c-module-d\xf9ng-\u0111\u1ec3-x\xe2y-d\u1ef1ng-b\u1ed9-x\u01b0\u01a1ng-cho-model-",children:"\u0110\u1ea7u ti\u1ec1n l\xe0 c\xe1c module d\xf9ng \u0111\u1ec3 x\xe2y d\u1ef1ng b\u1ed9 x\u01b0\u01a1ng cho model :"}),"\n",(0,l.jsx)("center",{children:(0,l.jsx)("img",{width:"600",height:"300",src:i(4883).A})}),"\n",(0,l.jsx)(e.p,{children:"\u0110\u1ea7u ti\xean ta t\xecm hi\u1ec3u sub-module : Models trong keras. \u0110\u1ec3 kh\u1edfi t\u1ea1o m\u1ed9t model trong keras ta c\xf3 th\u1ec3 d\xf9ng 2 c\xe1ch:"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["C\xe1ch 1 : Th\xf4ng qua  Sequential nh\u01b0 v\xed d\u1ee5 d\u01b0\u1edbi. Ch\xfang ta kh\u1edfi t\u1ea1o model b\u1eb1ng ",(0,l.jsx)(e.code,{children:"Sequential"})," sau \u0111\xf3 d\xf9ng method add \u0111\u1ec3 th\xeam c\xe1c layer."]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"import numpy as np\nfrom keras.models import Sequential,Model\n\nmodel = Sequential()\nmodel.add(Conv2D(32, kernel_size=(3, 3),\n                 activation='relu',\n                 input_shape=input_shape))\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dense(num_classes, activation='softmax'))\n\nmodel.compile(loss=keras.losses.categorical_crossentropy,\n              optimizer=keras.optimizers.Adadelta(),\n              metrics=['accuracy'])\n\nmodel.fit(x_train, y_train,\n          batch_size=batch_size,\n          epochs=epochs,\n          verbose=1,\n          validation_data=(x_test, y_test))\n"})}),"\n",(0,l.jsxs)(e.ol,{start:"2",children:["\n",(0,l.jsx)(e.li,{children:"C\xe1ch th\u1ee9 2 \u0111\u1ec3 kh\u1edfi t\u1ea1o model l\xe0 d\xf9ng function API . Nh\u01b0 v\xed d\u1ee5 d\u01b0\u1edbi"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"from keras.models import Model\nfrom keras.layers import Input, Dense\n\na = Input(shape=(32,))\nb = Dense(32)(a)\nmodel = Model(inputs=a, outputs=b)\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["N\xf3 c\u0169ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 computation graph, ch\xfang ta xem input c\u0169ng l\xe0 m\u1ed9t layer sau \u0111\xf3 build t\u1eeb input t\u1edbi output sau \u0111\xf3 k\u1ebft h\u1ee3p l\u1ea1i b\u1eb1ng h\xe0m  ",(0,l.jsx)(e.code,{children:"Model"}),". \u01afu \u0111i\u1ec3m c\u1ee7a ph\u01b0\u01a1ng ph\xe1p n\xe0y c\xf3 th\u1ec3 t\xf9y bi\u1ebfn nhi\u1ec1u h\u01a1n,gi\xfap ta x\xe2y d\u1ef1ng c\xe1c model ph\u1ee9c t\u1ea1p nhi\u1ec1u input v\xe0 output."]}),"\n",(0,l.jsx)(e.li,{children:"Khi ch\xfang ta kh\u1edfi t\u1ea1o m\u1ed9t model th\xec c\xf3 c\xe1c method ta c\u1ea7n l\u01b0u \xfd l\xe0 :"}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"compile"})," : Sau khi build model xong th\xec compile n\xf3 c\xf3 t\xe1c d\u1ee5ng bi\xean t\u1eadp l\u1ea1i to\xe0n b\u1ed9 model c\u1ee7a ch\xfang ta \u0111\xe3 build. \u1ede \u0111\xe2y ch\xfang ta c\xf3 th\u1ec3 ch\u1ecdn c\xe1c tham s\u1ed1 \u0111\u1ec3 training model nh\u01b0 : thu\u1eadt to\xe1n training th\xf4ng qua tham s\u1ed1 ",(0,l.jsx)(e.code,{children:"optimizer"}),", function loss c\u1ee7a model ch\xfang ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng m\u1eb7c \u0111\u1ecbnh ho\u1eb7c t\u1ef1 build th\xf4ng qua tham s\u1ed1 ",(0,l.jsx)(e.code,{children:"loss"}),", ch\u1ecdn metrics hi\u1ec7n th\u1ecb khi model \u0111\u01b0\u1ee3c training"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"summary"})," method n\xe0y gi\xfap ch\xfang ta t\u1ed5ng h\u1ee3p l\u1ea1i model xem model c\xf3 bao nhi\xeau layer, t\u1ed5ng s\u1ed1 tham s\u1ed1 bao nhi\xeau,shape c\u1ee7a m\u1ed7i layer.."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"fit"})," d\xf9ng \u0111\u1ec3 \u0111\u01b0a data v\xe0o training \u0111\u1ec3 t\xecm tham s\u1ed1 model(t\u01b0\u01a1ng t\u1ef1 nh\u01b0 sklearn)"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"predict"})," d\xf9ng \u0111\u1ec3 predict c\xe1c new instance"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"evaluate"})," \u0111\u1ec3 t\xednh to\xe1n \u0111\u1ed9 ch\xednh x\xe1c c\u1ee7a model"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"history"})," d\xf9ng \u0111\u1ec3 xem accuracy,loss qua t\u1eebng epochs . Th\u01b0\u1eddng d\xf9ng v\u1edbi matplotlib \u0111\u1ec3 v\u1ebd chart."]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"Ti\u1ebfp theo ch\xfang ta t\xecm hi\u1ec3u \u0111\xean sub-module Layers : N\xf3 ch\u1ee9a c\xe1c layers chuy\xean d\u1ee5ng \u0111\u1ec3 ta build c\xe1c model nh\u01b0 CNN,RNN,GANs..C\xf3 r\u1ea5t nhi\u1ec1u layers n\xean ta ch\u1ec9 quan t\xe2m \u0111\u1ebfn m\u1ed9t s\u1ed1 layer th\u01b0\u1eddng s\u1eed d\u1ee5ng."}),"\n",(0,l.jsx)("center",{children:(0,l.jsx)("img",{width:"600",height:"300",src:i(5172).A})}),"\n",(0,l.jsx)(e.p,{children:"Core layer : ch\u1ee9a c\xe1c layer m\xe0 h\u1ea7u nh\u01b0 model n\xe0o c\u0169ng s\u1eed d\u1ee5ng \u0111\u1ebfn n\xf3."}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Dense"})," layer n\xe0y s\u1eed d\u1ee5ng nh\u01b0 m\u1ed9t layer neural network b\xecnh th\u01b0\u1eddng. C\xe1c tham s\u1ed1 quan t\xe2m.","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"units"})," chi\u1ec1u output"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"activation"})," d\xf9ng \u0111\u1ec3 ch\u1ecdn activation."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"input_dim"})," chi\u1ec1u input n\u1ebfu l\xe0 layer \u0111\u1ea7u ti\xean"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"use_bias"})," c\xf3 s\u1eed d\u1ee5ng bias ko,true or false"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"kernel_initializer"})," kh\u1edfi t\u1ea1o gi\xe1 tr\u1ecb \u0111\u1ea7u cho tham s\u1ed1 trong layer tr\u1eeb bias"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"bias_initializer"})," kh\u1edfi t\u1ea1o gi\xe1 tr\u1ecb \u0111\u1ea7u cho bias"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"kernel_regularizer"})," regularizer cho coeff"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"bias_regularizer"})," regularizer cho bias"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"activity_regularizer"})," c\xf3 s\u1eed d\u1ee5ng regularizer cho output ko"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"kernel_constraint"}),",",(0,l.jsx)(e.code,{children:"bias_constraint"})," c\xf3 r\xe0ng bu\u1ed9c v\u1ec1 weight ko"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Activation"})," d\xf9ng \u0111\u1ec3 ch\u1ecdn activation trong layer(c\xf3 th\u1ec3 d\xf9ng tham s\u1ed1 activation thay th\u1ebf).Xem ph\u1ea7n sau."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Dropout"})," layer n\xe0y d\xf9ng nh\u01b0 regularization cho c\xe1c layer h\u1ea1n ch\u1ebf overfiting. Tham s\u1ed1 c\u1ea7n ch\xfa \xfd :","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"rate"})," t\u1ec9 l\u1ec7 dropout"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"noise_shape"})," c\xe1i n\xe0y ch\u01b0a t\xecm hi\u1ec3u"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"seed"})," random seed b\xecnh th\u01b0\u1eddng"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Flatten"})," d\xf9ng \u0111\u1ec3 l\xe1t ph\u1eb1ng layer \u0111\u1ec3 fully connection, vd : shape : 20x20 qua layer n\xe0y s\u1ebd l\xe0 400x1"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Input"})," layer n\xe0y s\u1eed d\u1ee5ng input nh\u01b0 1 layer nh\u01b0 vd tr\u01b0\u1edbc ta \u0111\xe3 n\xf3i."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Reshape"})," gi\u1ed1ng nh\u01b0 t\xean g\u1ecdi c\u1ee7a n\xf3, d\xf9ng \u0111\u1ec3 reshape"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Lambda"})," d\xf9ng nh\u01b0 lambda trong python th\xf4i ha"]}),"\n",(0,l.jsxs)(e.li,{children:["Convolutional Layers: ch\u1ee9a c\xe1c layer trong m\u1ea1ng n\u01a1 ron t\xedch ch\u1eadp . ",(0,l.jsx)(e.code,{children:"Conv1D"}),",",(0,l.jsx)(e.code,{children:"Conv2D"})," l\xe0 convolution layer d\xf9ng \u0111\u1ec3 l\u1ea5y feature t\u1eeb image. tham s\u1ed1 c\u1ea7n ch\xfa \xfd:","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"filters"})," s\u1ed1 filter c\u1ee7a convolution layer"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"kernel_size"})," size window search tr\xean image"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"strides"})," b\u01b0\u1edbc nh\u1ea3y m\u1ed7i window search"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"padding"})," same l\xe0 d\xf9ng padding,valid l\xe0 ko"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"data_format"})," format channel \u1edf \u0111\u1ea7u hay cu\u1ed1i"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"UpSampling1D"}),",",(0,l.jsx)(e.code,{children:"UpSampling2D"})," Ng\u01b0\u1ee3c l\u1ea1i v\u1edbi convolution layer","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"size"})," vd (2,2) c\xf3 ngh\u0129a m\u1ed7i pixel ban \u0111\u1ea7u s\u1ebd th\xe0nh 4 pixel"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"ZeroPadding1D"}),",",(0,l.jsx)(e.code,{children:"ZeroPadding2D"})," d\xf9ng \u0111\u1ec3 padding tr\xean image."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"padding"})," s\u1ed1 pixel padding"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Pooling Layers : Ch\u1ee9a c\xe1c layer d\xf9ng trong m\u1ea1ng CNN.","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"MaxPooling1D"}),",",(0,l.jsx)(e.code,{children:"MaxPooling2D"})," d\xf9ng \u0111\u1ec3 l\u1ea5y feature n\u1ed5i b\u1eadt(d\xf9ng max) v\xe0 gi\xfap gi\u1ea3m parameter khi training"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"pool_size"})," size pooling"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"AveragePooling1D"}),",",(0,l.jsx)(e.code,{children:"AveragePooling2D"})," gi\u1ed1ng nh\u01b0 maxpooling nh\u01b0ng d\xf9ng Average"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"GlobalMaxPooling1D"}),",",(0,l.jsx)(e.code,{children:"GlobalMaxPooling2D"})," ch\u01b0a d\xf9ng bao gi\u1edd n\xean ch\u01b0a hi\u1ec3u n\xf3 l\xe0m g\xec"]}),"\n",(0,l.jsxs)(e.li,{children:["Recurrent Layers ch\u1ee9a c\xe1c layers d\xf9ng trong m\u1ea1ng RNN","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"RNN"})," layer RNN c\u01a1 b\u1ea3n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"GRU"})," kh\u1eafc ph\u1ee5c h\u1ea1n ch\u1ebf RNN tr\xe1nh vanish gradient."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"LSTM"})," Long Short-Term Memory layer"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Embedding layer : ",(0,l.jsx)(e.code,{children:"Embedding"})," d\xf9ng trong nhi\u1ec1u trong nlp m\u1ee5c \u0111\xedch embbding sang m\u1ed9t kh\xf4ng gian m\u1edbi c\xf3 chi\u1ec1u nh\u1ecf h\u01a1n, v\xe0 dc learning from data thay cho one-hot lad hard code.","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"input_dim"})," size c\u1ee7a vocabulary"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"output_dim"})," size c\u1ee7a word embbding"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"input_length"})," chi\u1ec1u d\xe0i m\u1ed7i sequence"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Merge Layers ch\u1ee9a c\xe1c layers gi\xfap ch\xfang ta c\u1ed9ng,tr\u1eeb,ho\u1eb7c n\u1ed1i c\xe1c layer nh\u01b0 c\xe1c vector v\u1eady :","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Add"})," c\u1ed9ng c\xe1c layers"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Subtract"}),"tr\u1eeb c\xe1c layers"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Multiply"}),"nh\xe2n c\xe1c layer"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Average"})," t\xednh trung b\xecnh c\xe1c layers"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Maximum"})," l\u1ea5y maximun gi\u1eefa c\xe1c layers"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Concatenate"})," n\u1ed1i c\xe1c layer"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Dot"})," Nh\xe2n matrix gi\u1eef 2 layers\nOwn Keras layers : Gi\xfap ch\xfang ta c\xf3 th\u1ec3 x\xe2y d\u1ef1ng layer nh\u01b0 theo \xfd mu\u1ed1n, g\u1ed3m 3 method ch\xfang ta c\u1ea7n ch\xfa \xfd l\xe0 ",(0,l.jsx)(e.code,{children:"build"}),",",(0,l.jsx)(e.code,{children:"call"})," v\xe0 ",(0,l.jsx)(e.code,{children:"compute_output_shape"})]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"from keras import backend as K\nfrom keras.engine.topology import Layer\nimport numpy as np\n\nclass MyLayer(Layer):\n\n    def __init__(self, output_dim, **kwargs):\n        self.output_dim = output_dim\n        super(MyLayer, self).__init__(**kwargs)\n\n    def build(self, input_shape):\n        # Create a trainable weight variable for this layer.\n        self.kernel = self.add_weight(name='kernel', \n                                      shape=(input_shape[1], self.output_dim),\n                                      initializer='uniform',\n                                      trainable=True)\n        super(MyLayer, self).build(input_shape)  # Be sure to call this at the end\n\n    def call(self, x):\n        return K.dot(x, self.kernel)\n\n    def compute_output_shape(self, input_shape):\n        return (input_shape[0], self.output_dim)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"ti\u1ebfp-theo-ch\xfang-ta-t\xecm-hi\u1ec3u-\u0111\u1ebfn-ti\u1ec1n-x\u1eed-l\xfd-d\u1eef-li\u1ec7u-trong-keras-n\xf3-\u0111\u01b0\u1ee3c-chia-ra-l\xe0m-3-ph\u1ea7n-",children:"Ti\u1ebfp theo ch\xfang ta t\xecm hi\u1ec3u \u0111\u1ebfn ti\u1ec1n x\u1eed l\xfd d\u1eef li\u1ec7u trong keras, n\xf3 \u0111\u01b0\u1ee3c chia ra l\xe0m 3 ph\u1ea7n :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Sequence Preprocessing"})," ti\u1ec1n x\u1eed l\xfd chu\u1ed7i .","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"TimeseriesGenerator"})," c\xe1i n\xe0y d\xf9ng \u0111\u1ec3 t\u1ea1o d\u1eef li\u1ec7u cho time series"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"pad_sequences"})," d\xf9ng \u0111\u1ec3 padding gi\xfap c\xe1c chu\u1ed7i c\xf3 \u0111\u1ed9 d\xe0i b\u1eb1ng nhau"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"skipgrams"})," t\u1ea1o data trong model skip gram,k\u1ebft qu\u1ea3 tr\u1ea3 v\u1ec1 2 tuple n\u1ebfu word xu\u1ea5t hi\u1ec7n c\xf9ng nhau l\xe0 1 n\u1ebfu ko l\xe0 0."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Text Preprocessing"})," ti\u1ec1n x\u1eed l\xfd text","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Tokenizer"})," gi\u1ed1ng k\u1ef9 thu\u1eadt tokenizer trong nlp, t\u1ea1o tokenizer t\u1eeb documment"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"one_hot"})," t\u1ea1o data d\u1ea1ng one hot encoding"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"text_to_word_sequence"})," covert text th\xe0nh sequence"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Image Preprocessing"})," ti\u1ec1n x\u1eed l\xfd image","\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"ImageDataGenerator"})," t\u1ea1o th\xeam data b\u1eb1ng c\xe1ch scale,rotation..."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"c\xe1c-function-trong-b\u1ed9-x\u01b0\u01a1ng-c\u1ee7a-model",children:"C\xe1c function trong b\u1ed9 x\u01b0\u01a1ng c\u1ee7a model"}),"\n",(0,l.jsxs)(e.p,{children:["C\xe1c h\xe0m ",(0,l.jsx)(e.code,{children:"loss functions"})," th\u01b0\u1eddng d\xf9ng :"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"mean_squared_error"})," th\u01b0\u1eddng d\xf9ng trong regression t\xednh theo eculic"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"mean_absolute_error"})," t\xednh theo tr\u1ecb tuy\u1ec7t \u0111\u1ed1i"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"categorical_crossentropy"})," d\xf9ng trong classifier nhi\u1ec1u class"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"binary_crossentropy"})," d\xf9ng trong classifier 2 class"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"kullback_leibler_divergence"})," d\xf9ng \u0111\u1ec3 t\xednh loss gi\u1eefa ph\xe2n ph\u1ed1i th\u1ef1c t\u1ebf v\xe0 th\u1ef1c nghi\u1ec7m"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"metrics"})," n\xf3 l\xe0 th\u01b0\u1edbc \u0111o \u0111\u1ec3 ta \u0111\xe1nh gi\xe1 accuracy c\u1ee7a model :"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"binary_accuracy"})," n\u1ebfu y_true==y_pre th\xec tr\u1ea3 v\u1ec1 1 ng\u01b0\u1ee3c l\u1ea1i 0,d\xf9ng cho 2 class"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"categorical_accuracy"})," t\u01b0\u01a1ng t\u1ef1 binary_accuracy nh\u01b0ng cho nhi\u1ec1u class"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"optimizers"})," d\xf9ng \u0111\u1ec3 ch\u1ecdn thu\u1eadt to\xe1n training."]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"SGD"})," Stochastic gradient descent optimizer"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"RMSprop"})," RMSProp optimizer"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Adam"})," Adam optimizer"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"activations"})," \u0111\u1ec3 ch\u1ecdn activation function"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"linear"})," nh\u01b0 trong linear regression"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"softmax"})," d\xf9ng trong multi classifier"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"relu"})," max(0,x) d\xf9ng trong c\xe1c layer cnn,rnn \u0111\u1ec3 gi\u1ea3m chi ph\xed t\xednh to\xe1n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"tanh"})," range (-1,1)"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"Sigmoid"})," range (0,1) d\xf9ng nhi\u1ec1u trong binary class"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"Callbacks : khi model ch\xfang ta l\u1edbn c\xf3 khi training th\xec g\u1eb7p s\u1ef1 c\u1ed1 ta mu\u1ed1n l\u01b0u l\u1ea1i model \u0111\u1ec3 ch\u1ea1y l\u1ea1i th\xec callback gi\xfap t l\xe0m \u0111i\u1ec1u n\xe0y :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"ModelCheckpoint"})," l\u01b0u l\u1ea1i model sau m\u1ed7i epoch"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"EarlyStopping"})," stop training khi training ko c\u1ea3i thi\u1ec7n model"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"ReduceLROnPlateau"})," gi\u1ea3m learning m\u1ed7i khi metrics ko \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"Datasets. Keras h\u1ed7 tr\u1ee3 m\u1ed9t s\u1ed1 dataset theo c\xf4ng th\u1ee9c :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"cifar100"})," g\u1ed3m 50,000 32x32 color training images, labeled over 100 categories, and 10,000 test images."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"mnist"})," data 70k image data hand written."]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"fashion_mnist"})," Dataset of 70k 28x28 grayscale images of 10 fashion categories"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"imdb"})," 25,000 movies reviews from IMDB, label \u0111\xe1nh theo pos/neg"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"reuters"})," 11,228 newswires from Reuters, labeled over 46 topics"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"boston_housing"})," data gi\xe1 nh\xe0 \u1edf boston theo 13 features"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"from keras.datasets import name_data\n(X_train,X_test),(y_train,y_test) = name_data.load_data()\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"Applications"})," ch\u1ee9a c\xe1c pre-training weight c\u1ee7a c\xe1c model deep learning n\u1ed5i ti\u1ebfng.",(0,l.jsx)(e.code,{children:"Xception"}),",",(0,l.jsx)(e.code,{children:"VGG16"}),",",(0,l.jsx)(e.code,{children:"VGG19"}),",",(0,l.jsx)(e.code,{children:"resnet50"}),",",(0,l.jsx)(e.code,{children:"inceptionv3"}),",\n",(0,l.jsx)(e.code,{children:"InceptionResNetV2"}),",",(0,l.jsx)(e.code,{children:"MobileNet"}),",",(0,l.jsx)(e.code,{children:"DenseNet"}),",",(0,l.jsx)(e.code,{children:"NASNet"})," c\u1ea9u tr\xfac chung nh\u01b0 sau :"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"preprocess_input"})," d\xf9ng \u0111\u1ec3 preprocessing input custom same v\u1edbi input c\u1ee7a pretraining"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"decode_predictions"})," d\xf9ng \u0111\u1ec3 xem label predict"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"from keras.applications.name_pre_train import Name_pre_train\nfrom keras.applications.name_pre_train import preprocess_input, decode_predictions\nmodel = Name_pre_train(weights='t\xean dataset')\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"backends"})," banckend c\xf3 ngh\u0129a l\xe0 thay v\xec keras x\xe2y d\u1ef1ng t\u1eeb \u0111\u1ea7u c\xe1c c\xf4ng th\u1ee9c t\u1eeb \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn ph\u1ee9c t\u1ea1p, th\xec n\xf3 d\xf9ng nh\u1eefng th\u01b0 vi\u1ec7n \u0111\xe3 x\xe2y d\u1ef1ng s\u1eb5n r\u1ed3i v\xe0 d\xf9ng th\xf4i. Gi\xfap ti\u1ebft ki\u1ec7m dc th\u1eddi gian v\xe0 ch\xed ph\xed. Trong keras c\xf3 h\u1ed7 tr\u1ee3 3 backend l\xe0 tensorflow,theano v\xe0 CNTK.\n",(0,l.jsx)(e.code,{children:"initializers"})," kh\u1edfi t\u1ea1o gi\xe1 tr\u1ecb  weight c\u1ee7a coeff v\xe0 bias tr\u01b0\u1edbc khi training l\u1ea7n l\u01b0\u1ee3t ",(0,l.jsx)(e.code,{children:"kernel_initializer"})," and ",(0,l.jsx)(e.code,{children:"bias_initializer"}),". m\u1eb7c \u0111\u1ecbnh l\xe0 ",(0,l.jsx)(e.code,{children:"glorot_uniform"})," ph\xe2n ph\u1ed1i uniform v\u1edbi gi\xe1 tr\u1ecb 1/c\u0103n(input+output).\n",(0,l.jsx)(e.code,{children:"regularizers"})," D\xf9ng \u0111\u1ec3 ph\u1ea1t nh\u1eefng coeff n\xe0o t\xe1c \u0111\u1ed9ng qu\xe1 m\u1ea1nh v\xe0o m\u1ed7i layer th\u01b0\u1eddng d\xf9ng l\xe0 L1 v\xe0 L2\n",(0,l.jsx)(e.code,{children:"constraints"})," d\xf9ng \u0111\u1ec3 thi\u1ebft l\u1eadp c\xe1c \u0111i\u1ec1u ki\u1ec7n r\xe0ng bu\u1ed9c khi training\n",(0,l.jsx)(e.code,{children:"visualization"})," gi\xfap ch\xfang ta plot l\u1ea1i c\u1ea5u tr\xfac m\u1ea1ng neral network.\n",(0,l.jsx)(e.code,{children:"Utils"})," ch\u1ee9a c\xe1c function c\u1ea7n thi\u1ebft gi\xfap ta x\u1eed l\xfd data nhanh h\u01a1n.\n",(0,l.jsx)(e.code,{children:"normalize"})," chu\u1ea9n h\xf3a data theo L2\n",(0,l.jsx)(e.code,{children:"plot_model"})," gi\xfap ch\xfang ta plot model\n",(0,l.jsx)(e.code,{children:"to_categorical"})," covert class sang binary class matrix"]})]})}function o(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(a,{...n})}):a(n)}},4774:(n,e,i)=>{i.d(e,{A:()=>c});const c=i.p+"assets/images/keras0-d08db28274686ce6406b726cbd48b319.jpg"},4883:(n,e,i)=>{i.d(e,{A:()=>c});const c=i.p+"assets/images/keras1-3c3791262c5f8b611f5fb8586469a14e.jpg"},5172:(n,e,i)=>{i.d(e,{A:()=>c});const c=i.p+"assets/images/keras2-e0b48fb26386aa038ae5cdfed399483c.jpg"},5533:n=>{n.exports=JSON.parse('{"permalink":"/blog/T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning","editUrl":"https://github.com/ThorPham/blog/2018-5-25-T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning/index.md","source":"@site/blog/2018-5-25-T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning/index.md","title":"T\xecm hi\u1ec3u v\u1ec1 th\u01b0 vi\u1ec7n keras trong deep learning","description":"Keras l\xe0 m\u1ed9t library \u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n v\xe0o n\u0103m 2015 b\u1edfi Fran\xe7ois Chollet, l\xe0 m\u1ed9t k\u1ef9 s\u01b0 nghi\xean c\u1ee9u deep learning t\u1ea1i google. N\xf3 l\xe0 m\u1ed9t open source cho neural network \u0111\u01b0\u1ee3c vi\u1ebft b\u1edfi ng\xf4n ng\u1eef python. keras l\xe0 m\u1ed9t API b\u1eadc cao c\xf3 th\u1ec3 s\u1eed d\u1ee5ng chung v\u1edbi c\xe1c th\u01b0 vi\u1ec7n deep learning n\u1ed5i ti\u1ebfng nh\u01b0 tensorflow(\u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n b\u1edfi gg), CNTK(\u0111\u01b0\u1ee3c ph\xe1t tri\u1ec3n b\u1edfi microsoft),theano(ng\u01b0\u1eddi ph\xe1t tri\u1ec3n ch\xednh Yoshua Bengio). keras c\xf3 m\u1ed9t s\u1ed1 \u01b0u \u0111i\u1ec3m nh\u01b0 :","date":"2018-05-25T00:00:00.000Z","tags":[{"inline":true,"label":"python","permalink":"/blog/tags/python"},{"inline":true,"label":"Keras","permalink":"/blog/tags/keras"}],"readingTime":9.21,"hasTruncateMarker":true,"authors":[{"name":"Thorpham","title":"Deep learning enthusiast","url":"https://github.com/ThorPham","imageURL":"https://github.com/ThorPham.png","key":"thorpham","page":null}],"frontMatter":{"slug":"T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning","title":"T\xecm hi\u1ec3u v\u1ec1 th\u01b0 vi\u1ec7n keras trong deep learning","authors":"thorpham","tags":["python","Keras"],"hide_table_of_contents":true},"unlisted":false,"prevItem":{"title":"Nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay v\u1edbi sklearn v\xe0 opencv","permalink":"/blog/Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay"},"nextItem":{"title":"Feature extraction trong computer vision","permalink":"/blog/Feature-extraction-trong-computer-vision"}}')},8453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>t});var c=i(6540);const l={},s=c.createContext(l);function r(n){const e=c.useContext(s);return c.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),c.createElement(s.Provider,{value:e},n.children)}}}]);