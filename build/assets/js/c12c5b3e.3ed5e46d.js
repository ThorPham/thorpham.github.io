"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5659],{2425:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>m});var a=n(7930),l=n(4848),t=n(8453);const i={slug:"Drowsiness-detection",title:"Drowsiness detection v\u1edbi Dlib v\xe0 OpenCV",authors:"thorpham",tags:["opencv","python","Dlib"],hide_table_of_contents:!0},r=void 0,c={authorsImageUrls:[void 0]},m=[{value:"T\xecm hi\u1ec3u \xfd t\u01b0\u1edfng",id:"t\xecm-hi\u1ec3u-\xfd-t\u01b0\u1edfng",level:2},{value:"X\xe2y d\u1ef1ng model",id:"x\xe2y-d\u1ef1ng-model",level:2},{value:"Test model",id:"test-model",level:2}];function h(s){const e={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...s.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.p,{children:(0,l.jsx)(e.em,{children:"B\xe0i tr\u01b0\u1edbc ch\xfang ta \u0111\xe3 t\xecm hi\u1ec3u v\u1ec1 facial landmark. Trong b\xe0i n\xe0y ch\xfang ta s\u1ebd \u1ee9ng d\u1ee5ng facial landmark v\xe0o Drowsiness detection. Drowness detection\nd\xf9ng \u0111\u1ec3 x\xe1c \u0111\u1ecbnh tr\u1ea1ng th\xe1i ng\u1ee7 g\u1eadt hay kh\xf4ng d\u1ef1a v\xe0o facial landmark c\u1ee7a eye. Th\u01b0\u1eddng \u0111\u01b0\u1ee3c c\xe1i t\xe0i x\u1ebf x\u1eed d\u1ee5ng khi \u0111i\u1ec1u khi\u1ec3n ph\u01b0\u01a1ng ti\u1ec7n giao\nth\xf4ng \u0111\u1ec3 h\u1ea1n ch\u1ebf tai n\u1ea1n."})}),"\n",(0,l.jsx)(e.p,{children:"C\u1ea5u tr\xfac c\u1ee7a b\xe0i :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"T\xecm hi\u1ec3u \xfd t\u01b0\u1edfng."}),"\n",(0,l.jsx)(e.li,{children:"X\xe2y d\u1ef1ng model."}),"\n",(0,l.jsx)(e.li,{children:"Test model"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"t\xecm-hi\u1ec3u-\xfd-t\u01b0\u1edfng",children:"T\xecm hi\u1ec3u \xfd t\u01b0\u1edfng"}),"\n",(0,l.jsxs)(e.p,{children:["\xdd t\u01b0\u1edfng c\u0169ng r\u1ea5t \u0111\u01a1n gi\u1ea3n th\xf4i, l\xe0 ch\xfang ta s\u1ebd d\u1ef1a v\xe0o facial landmark c\u1ee7a eyes \u0111\u1ec3 x\xe1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c t\u1ec9 l\u1ec7 n\xe0o \u0111\xf3 nh\u01b0 m\u1ed9t ng\u01b0\u1ee1ng \u0111\u1ec3 xem x\xe9t\nm\u1eaft \u0111ang nh\u1eafm hay m\u1edf.Trong paper ",(0,l.jsx)(e.strong,{children:"Real-Time Eye Blink Detection using Facial Landmarks"})," c\u1ee7a ",(0,l.jsx)(e.strong,{children:"Tereza Soukupova"})," v\xe0 ",(0,l.jsx)(e.strong,{children:"Jan \xb4 Cech"})," \u0111\xe3\nt\xecm ra \u0111\u01b0\u1ee3c m\u1ed9t c\xf4ng th\u1ee9c gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y c\xf3 t\xean g\u1ecdi l\xe0 eye aspect ratio(EAR).Ch\xfang ta c\xf9ng t\xecm hi\u1ec3u qua v\u1ec1 c\xf4ng th\u1ee9c n\xe0y."]}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"E"}),(0,l.jsx)(e.mi,{children:"A"}),(0,l.jsx)(e.mi,{children:"R"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsxs)(e.mfrac,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"6"})]}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"3"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"5"})]}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mn,{children:"4"})]}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"EAR =  \\frac{||p_{2} - p_{6}|| + ||p_{3} - p_{5}||}{||p_{1} - p_{4}||}"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"E"}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"A"}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"2.363em",verticalAlign:"-0.936em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(e.span,{className:"mfrac",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.427em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"1"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"4"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"})]})]}),(0,l.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"6"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"3"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"5"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"})]})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.936em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["Trong \u0111\xf3 ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsx)(e.mrow,{children:(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mi,{children:"i"})]})}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"p_{i}"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})," l\xe0 lankmark point c\u1ee7a eye, k\xfd hi\u1ec7u ",(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"||"})]})})}),(0,l.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223\u2223"})]})})]})," l\xe0 kho\u1ea3ng c\xe1ch euclide."]}),"\n",(0,l.jsx)("p",{align:"center",children:(0,l.jsx)("img",{width:"600",height:"300",src:n(5093).A})}),"\n",(0,l.jsx)(e.p,{children:"\u0110\u1ed3 th\u1ecb EAR,trong \u0111\xf3 p1,p2,p3,p4,p5,p6 l\xe0 landmark point c\u1ee7a eye(l\u01b0u \xfd ta s\u1ebd k\xfd hi\u1ec7u b\u1eaft \u0111\u1ea7u b\u1eb1ng 0 thay v\xec b\u1eb1ng 1 trong model).Bi\u1ec3u \u0111\u1ed3 b\xean d\u01b0\u1edbi l\xe0 \u0111\u1ed3 th\u1ecb c\u1ee7a EAR . Khi m\xe0 eye ta th\u1ea5y l\xe0 EAR s\u1ebd n\u1eb1m d\u01b0\u1edbi threshold 0.15 v\xe0 b\xecnh th\u01b0\u1eddng c\u1ee7a n\xf3 s\u1ebd l\u1edbn h\u01a1n 0.25.\n\u0110\xf3 l\xe0 \xfd t\u01b0\u1edfng c\u1ee7a b\xe0i to\xe1n.\u1ede \u0111\xe2y c\xf3 1 s\u1ed1 l\u01b0u \xfd l\xe0 :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"C\xf3 2 eye n\xean ta s\u1ebd l\u1ea5y trung b\xecnh c\u1ee7a 2 eye \u0111\u1ec3 l\u1ea5y EAR"}),"\n",(0,l.jsx)(e.li,{children:"\u0110\u1ec3 tr\xe1nh tr\u01b0\u1eddng h\u1ee3p nh\xe1y m\u1eaft hay hay detection sai ta s\u1ebd cho EAR m\u1ed9t kho\u1ea3ng th\u1eddi gian \u0111\u1ee7 l\xe2u \u0111\u1ec3 x\xe1c nh\u1eadn l\xe0 drowsiness."}),"\n",(0,l.jsx)(e.li,{children:"Threshold s\u1ebd do ta ch\u1ecdn theo \xfd mu\u1ed1n ta ta th\u1ea5y h\u1ee3p l\xfd."}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"x\xe2y-d\u1ef1ng-model",children:"X\xe2y d\u1ef1ng model"}),"\n",(0,l.jsx)(e.p,{children:"Tr\u01b0\u1edbc h\u1ebft ta x\xe2y d\u1ef1ng c\xe1c h\xe0m helper .\n\u0110\u1ea7u ti\xean l\xe0 h\xe0m chuy\u1ec3n landmark point th\xe0nh array . V\xec m\u1eb7c \u0111\u1ecbnh n\xf3 r\u1ea5t kh\xf3 x\xe0i."}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"def landmark_transform(landmarks):\n    land_mark_array = []\n    for i in landmarks:\n        land_mark_array.append([int(i.x),int(i.y)])\n    return np.array(land_mark_array)\n"})}),"\n",(0,l.jsx)(e.p,{children:"Ti\u1ebfp theo l\xe0 h\xe0m t\xednh EAR."}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"def calculate_distance(eye):\n    assert len(eye)== 6\n    p0,p1,p2,p3,p4,p5 = eye\n    distance_p1_p5 = np.sqrt((p1[0]-p5[0])**2 + (p1[1]-p5[1])**2)\n    distance_p2_p4 = np.sqrt((p2[0]-p4[0])**2 + (p2[1]-p4[1])**2)\n    distance_p0_p3 = np.sqrt((p0[0]-p3[0])**2 + (p0[1]-p3[1])**2)\n    EAR = (distance_p1_p5 + distance_p2_p4)/(2*distance_p0_p3)\n    return EAR\n"})}),"\n",(0,l.jsxs)(e.p,{children:["Ti\u1ebfp theo l\xe0 h\xe0m v\u1ebd contours cho eye \u0111\u1ec3 ti\u1ec7n theo d\xf5i. Ch\xfang ta d\xf9ng ",(0,l.jsx)(e.code,{children:"convexhull"})," \u0111\u1ec3 x\u1ea5p x\u1ec9 h\xecnh elip gi\u1ed1ng v\u1edbi eye."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:"def draw_contours(image,cnt):\n    hull = cv2.convexHull(cnt)\n    cv2.drawContours(image,[hull],-1,(0,255,0),2)\n"})}),"\n",(0,l.jsxs)(e.p,{children:["Cu\u1ed1i c\xf9ng l\xe0 h\xe0m ",(0,l.jsx)(e.strong,{children:"alarm"})," (th\xf4ng b\xe1o) khi drowsiness \u0111\u01b0\u1ee3c ph\xe1t hi\u1ec7n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:'def sound_alarm():\n    playsound.playsound("sound.mp3")\n'})}),"\n",(0,l.jsx)(e.p,{children:"B\xe2y gi\u1edd ta g\u1ed9p c\xe1c function helper \u0111\xe3 t\u1ea1o th\xe0nh m\u1ed9t model ho\xe0n ch\u1ec9nh."}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-py",children:'path = "shape_predictor_68_face_landmarks.dat"\ndetector = dlib.get_frontal_face_detector()\npredict_landmark = dlib.shape_predictor(path)\n\ncap = cv2.VideoCapture(0)\ntotal=0\nalarm = False\nwhile cap.isOpened() == True :\n    ret,frame = cap.read()\n    frame_gray = cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)\n    rects = detector(frame_gray,1)\n    if len(rects) > 0 :\n        for i in rects:\n            cv2.rectangle(frame,(i.left(),i.top()),(i.right(),i.bottom()),(0,255,0),2)\n            land_mark = predict_landmark(frame_gray,i)\n            left_eye = landmark_transform(land_mark.parts()[36:42])\n            right_eye = landmark_transform(land_mark.parts()[42:48])\n            draw_contours(frame,left_eye)\n            draw_contours(frame,right_eye)\n            EAR_left,EAR_right = calculate_distance(left_eye),calculate_distance(right_eye)\n            ear = np.round((EAR_left+EAR_right)/2,2)\n            cv2.putText(frame, "EAR :" + str(ear) ,(200, 100),cv2.FONT_HERSHEY_SIMPLEX, 1.7, (0, 255, 0), 2)\n            if ear > 0.25 :\n                total=0\n                alarm=False\n                cv2.putText(frame, "Eyes Open ", (10, 30),cv2.FONT_HERSHEY_SIMPLEX, 1.2, (0,255, 0 ), 2)\n            else:\n                total+=1\n                print(total)\n                if total>10:\n                    if not alarm:\n                        sound_alarm()\n                        cv2.putText(frame, "drowsiness detect" ,(10, 30),cv2.FONT_HERSHEY_SIMPLEX, 1.2, (0, 255, 0), 2)\n    cv2.imshow("image", frame)\n    if cv2.waitKey(1) & 0xFF == ord(\'q\'):\n        cv2.destroyAllWindows()\n        cap.release()\n        break               \n'})}),"\n",(0,l.jsx)(e.p,{children:"Gi\u1ea3i th\xedch code m\u1ed9t t\xed .( l\u01b0u \xfd c\xe1c tham s\u1ed1 do m\xecnh ch\u1ecdn c\xe1c b\u1ea1n c\xf3 th\u1ec3 \u0111i\u1ec1u ch\u1ec9nh theo \xfd m\xecnh)."}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Ta s\u1ebd kh\xf4ng nh\u1eafc l\u1ea1i c\xe1ch t\xecm facial landmark v\u1edbi faced detection v\u1edbi Dlib( b\u1ea1n \u0111\u1ecdc c\xf3 th\u1ec3 xem l\u1ea1i \u1edf b\xe0i tr\u01b0\u1edbc)"}),"\n",(0,l.jsx)(e.li,{children:"C\xe1c th\xf4ng s\u1ed1 ta \u0111\u1eb7t trong model : threshold c\u1ee7a EAR l\xe0 0.25(nh\u1ecf h\u01a1n s\u1ebd xem l\xe0 close eye)"}),"\n",(0,l.jsx)(e.li,{children:"Point landmark c\u1ee7a eye: left_eye : 37-42,right_eye : 43-49"}),"\n",(0,l.jsxs)(e.li,{children:['Ta s\u1ebd \u0111\u1ebfm s\u1ed1 l\u1ea7n eye close n\u1ebfu n\xf3 v\u01b0\u1ee3t qu\xe1 10 th\xec s\u1ebd c\xf3 "alarm" qua bi\u1ebfn l\xe0 ',(0,l.jsx)(e.code,{children:"total"})]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"detector"})," v\xe0 ",(0,l.jsx)(e.code,{children:"predict_landmark"})," d\xf9ng \u0111\u1ec3 detection face v\xe0 landmark"]}),"\n",(0,l.jsxs)(e.li,{children:["N\u1ebfu ",(0,l.jsx)(e.code,{children:"detector"})," th\u1ea5y face th\xec ta s\u1ebd t\xednh",(0,l.jsx)(e.code,{children:" EAR_left"})," v\xe0 ",(0,l.jsx)(e.code,{children:"EAR_right"})," sau \u0111\xf3 t\xednh trung b\xecnh \u0111\u01b0\u1ee3c ",(0,l.jsx)(e.code,{children:"ear"})]}),"\n",(0,l.jsxs)(e.li,{children:["Cu\u1ed1i c\xf9ng xem x\xe9t \u0111i\u1ec1u ki\u1ec7n n\u1ebfu total >10 th\xec s\u1ebd ",(0,l.jsx)(e.code,{children:"alarm"})]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"test-model",children:"Test model"}),"\n",(0,l.jsxs)(e.p,{children:["Ta s\u1ebd test th\u1eed model. V\xec m\xe1y m\xecnh c\u0169 v\xe0 webcame r\u1ea5t t\u1ed1i n\xean nhi\u1ec1u khi b\u1ecb lag ho\u1eb7c \u0111\u1ee9ng h\xecnh.\n[",(0,l.jsx)(e.a,{href:"https://www.youtube.com/watch?v=oROrBeClnec",children:"https://www.youtube.com/watch?v=oROrBeClnec"}),"]"]}),"\n",(0,l.jsx)("div",{class:"x-frame video","data-video":"https://www.youtube.com/watch?v=oROrBeClnec"}),"\n",(0,l.jsx)(e.p,{children:"Tham Kh\u1ea3o :"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"http://hanzratech.in/",children:"http://hanzratech.in/"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://pyimagesearch.com",children:"https://pyimagesearch.com"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://learnopencv.com",children:"https://learnopencv.com"})}),"\n"]})]})}function d(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(h,{...s})}):h(s)}},5093:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/drowness1-4f4f08cdee82cdef9d42a362dc3740b6.jpg"},7930:s=>{s.exports=JSON.parse('{"permalink":"/blog/Drowsiness-detection","editUrl":"https://github.com/ThorPham/blog/2018-4-21-Drowsiness-detection /index.mdx","source":"@site/blog/2018-4-21-Drowsiness-detection /index.mdx","title":"Drowsiness detection v\u1edbi Dlib v\xe0 OpenCV","description":"*B\xe0i tr\u01b0\u1edbc ch\xfang ta \u0111\xe3 t\xecm hi\u1ec3u v\u1ec1 facial landmark. Trong b\xe0i n\xe0y ch\xfang ta s\u1ebd \u1ee9ng d\u1ee5ng facial landmark v\xe0o Drowsiness detection. Drowness detection","date":"2018-04-21T00:00:00.000Z","tags":[{"inline":true,"label":"opencv","permalink":"/blog/tags/opencv"},{"inline":true,"label":"python","permalink":"/blog/tags/python"},{"inline":true,"label":"Dlib","permalink":"/blog/tags/dlib"}],"readingTime":4.24,"hasTruncateMarker":true,"authors":[{"name":"Thorpham","title":"Deep learning enthusiast","url":"https://github.com/ThorPham","imageURL":"https://github.com/ThorPham.png","key":"thorpham","page":null}],"frontMatter":{"slug":"Drowsiness-detection","title":"Drowsiness detection v\u1edbi Dlib v\xe0 OpenCV","authors":"thorpham","tags":["opencv","python","Dlib"],"hide_table_of_contents":true},"unlisted":false,"prevItem":{"title":"Feature extraction trong computer vision","permalink":"/blog/Feature-extraction-trong-computer-vision"},"nextItem":{"title":"T\xecm hi\u1ec3u eigenFace trong face recognite","permalink":"/blog/T\xecm-hi\u1ec3u-eigenFace-trong-face-recognite"}}')},8453:(s,e,n)=>{n.d(e,{R:()=>i,x:()=>r});var a=n(6540);const l={},t=a.createContext(l);function i(s){const e=a.useContext(t);return a.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(l):s.components||l:i(s.components),a.createElement(t.Provider,{value:e},s.children)}}}]);