"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1610],{4688:n=>{n.exports=JSON.parse('{"permalink":"/blog/Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay","editUrl":"https://github.com/ThorPham/blog/2018-06-4-Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay/index.md","source":"@site/blog/2018-06-4-Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay/index.md","title":"Nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay v\u1edbi sklearn v\xe0 opencv","description":"C\xf3 r\u1ea5t nhi\u1ec1u thu\u1eadt to\xe1n \u0111\u1ec3 nh\u1eadn di\u1ec7n ch\u1eef s\u1ed1 vi\u1ebft tay (hand writen digit) nh\u01b0 neural network,CNN v\u1edbi \u0111\u1ed9 ch\xednh x\xe1c r\u1ea5t cao l\xean t\u1edbi 99%. Nh\u01b0ng c\u0169ng kh\xf4ng n\xean ph\u1ee7 nh\u1eadn c\xe1c thu\u1eadt to\xe1n \xe1p d\u1ee5ng theo ki\u1ec3u truy\u1ec1n th\u1ed1ng tuy v\u1eabn c\xf3 nhi\u1ec1u \u01b0u \u0111i\u1ec3m l\xe0 \u0111\u01a1n gi\u1ea3n v\xe0 chi ph\xed t\xednh to\xe1n th\xe2p.Trong b\xe0i vi\u1ebft n\xe0y ch\xfang ta c\xf9ng t\xecm hi\u1ec3u Hog(histogram of oriented gradient) v\xe0 svm( support vector machine) \u0111\u1ec3 nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay tr\xean b\u1ed9 d\u1eef li\u1ec7u MNIST.","date":"2018-06-04T00:00:00.000Z","tags":[{"inline":true,"label":"opencv","permalink":"/blog/tags/opencv"},{"inline":true,"label":"sklearn","permalink":"/blog/tags/sklearn"}],"readingTime":3.62,"hasTruncateMarker":true,"authors":[{"name":"Thorpham","title":"Deep learning enthusiast","url":"https://github.com/ThorPham","imageURL":"https://github.com/ThorPham.png","key":"thorpham","page":null}],"frontMatter":{"slug":"Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay","title":"Nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay v\u1edbi sklearn v\xe0 opencv","authors":"thorpham","hide_table_of_contents":true,"tags":["opencv","sklearn"]},"unlisted":false,"prevItem":{"title":"Sentiment Analysis s\u1eed d\u1ee5ng Tf-Idf \xe1p d\u1ee5ng cho ng\xf4n ng\u1eef ti\u1ebfng vi\u1ec7t","permalink":"/blog/Sentiment-Analysis-s\u1eed-d\u1ee5ng-Tf-Idf"},"nextItem":{"title":"T\xecm hi\u1ec3u v\u1ec1 th\u01b0 vi\u1ec7n keras trong deep learning","permalink":"/blog/T\xecm-hi\u1ec3u-v\u1ec1-th\u01b0-vi\u1ec7n-keras-trong-deep-learning"}}')},6015:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>o,contentTitle:()=>h,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var i=e(4688),r=e(4848),c=e(8453);const a={slug:"Nh\u1eadn-d\u1ea1ng-ch\u1eef-s\u1ed1-vi\u1ebft-tay",title:"Nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay v\u1edbi sklearn v\xe0 opencv",authors:"thorpham",hide_table_of_contents:!0,tags:["opencv","sklearn"]},h=void 0,o={authorsImageUrls:[void 0]},l=[{value:"X\xe2y d\u1ef1ng model nh\u1eadn di\u1ec7n digit.",id:"x\xe2y-d\u1ef1ng-model-nh\u1eadn-di\u1ec7n-digit",level:2},{value:"Predict tr\xean \u1ea3nh c\xf3 nhi\u1ec1u ditgit",id:"predict-tr\xean-\u1ea3nh-c\xf3-nhi\u1ec1u-ditgit",level:2}];function s(n){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:(0,r.jsx)(t.em,{children:"C\xf3 r\u1ea5t nhi\u1ec1u thu\u1eadt to\xe1n \u0111\u1ec3 nh\u1eadn di\u1ec7n ch\u1eef s\u1ed1 vi\u1ebft tay (hand writen digit) nh\u01b0 neural network,CNN v\u1edbi \u0111\u1ed9 ch\xednh x\xe1c r\u1ea5t cao l\xean t\u1edbi 99%. Nh\u01b0ng c\u0169ng kh\xf4ng n\xean ph\u1ee7 nh\u1eadn c\xe1c thu\u1eadt to\xe1n \xe1p d\u1ee5ng theo ki\u1ec3u truy\u1ec1n th\u1ed1ng tuy v\u1eabn c\xf3 nhi\u1ec1u \u01b0u \u0111i\u1ec3m l\xe0 \u0111\u01a1n gi\u1ea3n v\xe0 chi ph\xed t\xednh to\xe1n th\xe2p.Trong b\xe0i vi\u1ebft n\xe0y ch\xfang ta c\xf9ng t\xecm hi\u1ec3u Hog(histogram of oriented gradient) v\xe0 svm( support vector machine) \u0111\u1ec3 nh\u1eadn d\u1ea1ng ch\u1eef s\u1ed1 vi\u1ebft tay tr\xean b\u1ed9 d\u1eef li\u1ec7u MNIST."})}),"\n",(0,r.jsx)(t.p,{children:"C\u1ea5u tr\xfac b\xe0i vi\u1ebft:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"X\xe2y d\u1ef1ng model nh\u1eadn di\u1ec7n digit."}),"\n",(0,r.jsx)(t.li,{children:"Predict tr\xean \u1ea3nh c\xf3 nhi\u1ec1u ditgit"}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"x\xe2y-d\u1ef1ng-model-nh\u1eadn-di\u1ec7n-digit",children:"X\xe2y d\u1ef1ng model nh\u1eadn di\u1ec7n digit."}),"\n",(0,r.jsx)(t.p,{children:'D\u1eef li\u1ec7u m\xe0 ch\xfang ta training model l\xe0 mnist. \u0110\xe2y c\xf3 th\u1ec3 coi l\xe0 "hello word" trong machine learning. Tr\u01b0\u1edbc h\u1ebft ta t\xecm hi\u1ec3u s\u01a1 qua v\u1ec1 d\u1eef li\u1ec7u, mnist l\xe0 t\u1eadp h\u1ee3p c\xe1c \u1ea3nh x\xe1m v\u1ec1 digit c\xf3 chi\u1ec1u l\xe0 28x28 bao g\u1ed3m 70.000 ng\xe0n \u1ea3nh, trong \u0111\xf3 c\xf3 60.000 \u1ea3nh \u0111\u1ec3 training v\xe0 10.000 \u1ea3nh \u0111\u1ec3 testing. \xdd t\u01b0\u1edfng c\u1ee7a model l\xe0 d\xf9ng HOG(histogram oriented of gradient) \u0111\u1ec3 extract feature( c\xe1c b\u1ea1n c\xf3 th\u1ec3 coi c\xe1c b\xe0i tr\u01b0\u1edbc \u0111\u1ec3 bi\u1ebft th\xeam hog l\xe0 g\xec). Sau khi c\xf3 feature ta s\u1ebd \u0111\u01b0a v\xe0o model SVM \u0111\u1ec3 ph\xe2n lo\u1ea1i. Cu\u1ed1i c\xf9ng d\xf9ng opencv \u0111\u1ebf segmentation digit v\xe0 d\xf9ng model ch\xfang ta v\u1eeba build \u0111\u1ec3 predict. B\u1eaft tay v\xe0o model n\xe0o.'}),"\n",(0,r.jsx)(t.p,{children:"\u0110\u1ea7u ti\xean load dataset v\xe0 load c\xe1c th\u01b0 vi\u1ec7n c\u1ea7n d\xf9ng:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:"import cv2\nimport numpy as np\nfrom skimage.feature import hog\nfrom sklearn.svm import LinearSVC\nfrom keras.datasets import mnist\nfrom sklearn.metrics import accuracy_score\n#load data\n(X_train,y_train),(X_test,y_test) = mnist.load_data()\n"})}),"\n",(0,r.jsx)(t.p,{children:"Ti\u1ebfp theo ta s\u1ebd t\xednh hog. Ta d\xf9ng orientations=9,pixels_per_cell=(14,14),cells_per_block=(1,1)."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:'#cho x_train\nX_train_feature = []\nfor i in range(len(X_train)):\n    feature = hog(X_train[i],orientations=9,pixels_per_cell=(14,14),cells_per_block=(1,1),block_norm="L2")\n    X_train_feature.append(feature)\nX_train_feature = np.array(X_train_feature,dtype = np.float32)\n\n#cho x_test\nX_test_feature = []\nfor i in range(len(X_test)):\n    feature = hog(X_test[i],orientations=9,pixels_per_cell=(14,14),cells_per_block=(1,1),block_norm="L2")\n    X_test_feature.append(feature)\nX_test_feature = np.array(X_test_feature,dtype=np.float32)\n'})}),"\n",(0,r.jsx)(t.p,{children:"Ti\u1ebfp theo ta build model v\xe0o predict"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:"model = LinearSVC(C=10)\nmodel.fit(X_train_feature,y_train)\ny_pre = model.predict(X_test_feature)\nprint(accuracy_score(y_test,y_pre))\n"})}),"\n",(0,r.jsx)(t.p,{children:"Accuracy l\xe0 88% kh\xf4ng cao l\u1eafm. Ta c\xf3 th\u1ec3 \u0111i\u1ec1u ch\u1ec9nh c\xe1c tham s\u1ed1 \u0111\u1ec3 t\u0103ng \u0111\u1ed9 ch\xednh x\xe1c c\u1ee7a model."}),"\n",(0,r.jsx)(t.h2,{id:"predict-tr\xean-\u1ea3nh-c\xf3-nhi\u1ec1u-ditgit",children:"Predict tr\xean \u1ea3nh c\xf3 nhi\u1ec1u ditgit"}),"\n",(0,r.jsx)(t.p,{children:"\u0110\u1ebfn b\u01b0\u1edbc n\xe0y ta s\u1ebd d\xf9ng opencv, \u0111\u1ea7u ti\xean ta s\u1ebd x\u1eed l\xfd \u1ea3nh v\xe0 t\xecm contours c\u1ee7a digit tr\xean image.\nImage n\xe0y l\u01b0\u1ee3m tr\xean m\u1ea1ng ha."}),"\n",(0,r.jsx)("center",{children:(0,r.jsx)("img",{width:"600",height:"200",src:e(8924).A})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:'image = cv2.imread("digit.jpg")\nim_gray = cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)\nim_blur = cv2.GaussianBlur(im_gray,(5,5),0)\nim,thre = cv2.threshold(im_blur,90,255,cv2.THRESH_BINARY_INV)\n_,contours,hierachy = cv2.findContours(thre,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)\nrects = [cv2.boundingRect(cnt) for cnt in contours]\n'})}),"\n",(0,r.jsx)(t.p,{children:"G\u1ea3i th\xedch code m\u1ed9t t\xed hem:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"\u0110\u1ea7u ti\xean convert color sang gray color"}),"\n",(0,r.jsx)(t.li,{children:"Ti\u1ebfp theo gi\u1ea3m nhi\u1ec5u b\u1eb1ng Gaussian( t\xf9y thu\u1ed9c image m\xe0 ta x\u1eed l\xfd kh\xe1c nhau)"}),"\n",(0,r.jsx)(t.li,{children:"Ti\u1ebfp theo d\xf9ng threshold chuy\u1ec3n v\u1ec1 \u1ea3nh binary"}),"\n",(0,r.jsx)(t.li,{children:"Cu\u1ed1i c\xf9ng l\xe0 t\xecm contour v\xe0 v\u1ebd bouding box\nSau \u0111\xf3 predict ditgit c\u1ee7a m\u1ed7i box."}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-py",children:'for i in contours:\n    (x,y,w,h) = cv2.boundingRect(i)\n    cv2.rectangle(image,(x,y),(x+w,y+h),(0,255,0),3)\n    roi = thre[y:y+h,x:x+w]\n    roi = np.pad(roi,(20,20),\'constant\',constant_values=(0,0))\n    roi = cv2.resize(roi, (28, 28), interpolation=cv2.INTER_AREA)\n    roi = cv2.dilate(roi, (3, 3))\n    \n    # Calculate the HOG features\n    roi_hog_fd = hog(roi, orientations=9, pixels_per_cell=(14, 14), cells_per_block=(1, 1),block_norm="L2")\n    nbr = model.predict(np.array([roi_hog_fd], np.float32))\n    cv2.putText(image, str(int(nbr[0])), (x, y),cv2.FONT_HERSHEY_DUPLEX, 2, (0, 255, 255), 3)\n    cv2.imshow("image",image)\ncv2.imwrite("image_pand.jpg",image)\ncv2.waitKey()\ncv2.destroyAllWindows()\n'})}),"\n",(0,r.jsx)("center",{children:(0,r.jsx)("img",{width:"600",height:"200",src:e(9310).A})}),"\n",(0,r.jsx)(t.p,{children:"M\u1ed9t s\u1ed1 l\u01b0u \xfd l\xe0 : Ta n\xean padding cho m\u1ed7i digit m\u1ed9t kho\u1ea3ng n\xe0o \u0111\xf3 tr\xe1nh tr\u01b0\u1eddng h\u1ee3p digit ko c\xf3 background s\u1ebd kh\xf3 predict. Tuy thu\u1eadt to\xe1n hog + svm n\xe0y c\xf3 \u0111\u1ed9 ch\xednh x\xe1c kh\xf4ng cao b\u1eb1ng c\xe1c thu\u1eadt to\xe1n trong deep learning nh\u01b0ng n\xf3 v\u1eabn t\u1ea1m ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c.M\xecnh vi\u1ebft b\xe0i n\xe0y \u0111\u1ec3 m\u1ecdi ng\u01b0\u1eddi h\xecnh dung \u0111\u01b0\u1ee3c c\xe1c b\u01b0\u1edbc th\u1ef1c hi\u1ec7n thu\u1eadt to\xe1n v\xe0 c\xe1c predict khi detection multi digit."}),"\n",(0,r.jsx)(t.p,{children:"Tham Kh\u1ea3o :"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"http://hanzratech.in/",children:"http://hanzratech.in/"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://pyimagesearch.com",children:"https://pyimagesearch.com"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"http://learnopencv.com",children:"http://learnopencv.com"})}),"\n"]})]})}function d(n={}){const{wrapper:t}={...(0,c.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(s,{...n})}):s(n)}},8453:(n,t,e)=>{e.d(t,{R:()=>a,x:()=>h});var i=e(6540);const r={},c=i.createContext(r);function a(n){const t=i.useContext(c);return i.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function h(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),i.createElement(c.Provider,{value:t},n.children)}},8924:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/digit-16bb6bbd28eb6a01f8a3acae486973ef.jpg"},9310:(n,t,e)=>{e.d(t,{A:()=>i});const i=e.p+"assets/images/ditgit-predict-c8dd45dd73daf073539ada6d220361f4.jpg"}}]);